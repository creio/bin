#!/usr/bin/env bash
#
# Simple backup script.
#
# Creates tar archives of directories and copies them
# to a dated folder on external drive. Lists existing
# backups if no arg is provided.
#
# Usage: bup, bup [name]

[ "$1" ] || {
  ls -l /media/seagate/backups
  exit
}

s=/media/seagate/backups
d="$(date +%Y%m%d-%H%M%S)"
n="$s/$1-$d"

sudo mkdir -v "$n"

bups=(
  "documents"
  "dotfiles"
  "Downloads"
  "github"
  "pictures"
  "projects"
)

for b in "${bups[@]}"; do
  sudo tar \
      --exclude-vcs \
      --exclude="node_modules" \
      --exclude="target" \
      --exclude=".next" \
      --exclude="dist" \
      --exclude="build" \
      -zcvf "$n/$b.tar" "$HOME/$b"
done

printf '\nDone.\n\n'
